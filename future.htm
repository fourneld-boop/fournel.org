<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>fournel.org – Futures & Timelines</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description"
        content="Future scenarios and timelines after 2025 – WW3, Skynet, alien contact, AI futures, Bahá’í futures, and the Solar System in 3000 AD.">

  <style>
    :root{
      --bg:#020612;
      --glass:rgba(15,23,42,.78);
      --glass2:rgba(8,12,24,.86);
      --card:rgba(15,23,42,.92);
      --accent:#4fd1ff;
      --accent2:#a855ff;
      --text:#f4f7ff;
      --muted:#9ba4c4;
      --border:rgba(255,255,255,.12);
      --border2:rgba(148,163,253,.35);
      --shadow:0 22px 60px rgba(0,0,0,.7);
      --radius:18px;
      --max:1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",sans-serif;
      color:var(--text);
      background:#020612 url('wormhole.gif') center center fixed no-repeat;
      background-size:cover;
      overflow-x:hidden;
      position:relative;
    }
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}

    /* Dark overlay for readability */
    body::before{
      content:"";
      position:fixed;inset:0;
      background:
        radial-gradient(circle at 10% 0, rgba(15,23,42,0.92) 0, transparent 55%),
        radial-gradient(circle at 90% 0, rgba(76,29,149,0.78) 0, transparent 55%),
        radial-gradient(circle at 50% 80%, rgba(15,23,42,0.96) 0, rgba(3,7,18,0.98) 70%);
      z-index:-1;pointer-events:none;
    }

    .wormhole-ring{
      position:fixed;left:50%;top:42%;
      width:380px;height:380px;margin-left:-190px;margin-top:-190px;border-radius:50%;
      border:1px dashed rgba(158,195,255,.35);
      box-shadow:0 0 30px rgba(79,209,255,.45), 0 0 80px rgba(0,0,0,.9) inset;
      z-index:-1;pointer-events:none;opacity:.62;
      animation:spinRing 32s linear infinite reverse;
    }
    @keyframes spinRing{from{transform:rotate(0)}to{transform:rotate(-360deg)}}

    /* Header */
    header{
      position:sticky;top:0;z-index:10;
      backdrop-filter:blur(18px);
      background:radial-gradient(circle at top, rgba(15,23,42,.96), rgba(15,23,42,.88));
      border-bottom:1px solid var(--border);
    }
    .nav{
      max-width:var(--max);margin:0 auto;padding:.7rem 1.5rem;
      display:flex;align-items:center;justify-content:space-between;gap:1rem;
    }
    .nav-left{display:flex;align-items:center;gap:.7rem}
    .nav-logo{
      width:36px;height:36px;border-radius:999px;
      background:
        radial-gradient(circle at 30% 25%, #fff, #b9e6ff 48%, transparent 62%),
        radial-gradient(circle at 70% 75%, #a855ff, #22d3ee 55%, #020617 80%);
      box-shadow:0 0 0 2px rgba(255,255,255,.75), 0 0 40px rgba(59,130,246,.65);
    }
    .nav-title{font-weight:600;letter-spacing:.03em;font-size:.95rem}
    .nav-title span{color:var(--muted);display:block;font-size:.75rem;text-transform:uppercase}
    .nav-links{display:flex;gap:.85rem;flex-wrap:wrap;font-size:.86rem}
    .nav-links a{
      padding:.25rem .7rem;border-radius:999px;border:1px solid transparent;
      color:var(--muted);transition:.2s;
    }
    .nav-links a:hover{
      color:var(--text);
      border-color:rgba(79,209,255,.18);
      background:rgba(15,23,42,.78);
      transform:translateY(-1px);
      text-decoration:none;
    }
    .nav-links a.active{
      color:var(--text);
      border-color:rgba(79,209,255,.18);
      background:rgba(15,23,42,.95);
    }

    main{max-width:var(--max);margin:0 auto;padding:2.4rem 1.5rem 4rem;position:relative;z-index:1}

    /* Hero */
    .hero{
      display:grid;grid-template-columns:minmax(0,1.8fr) minmax(0,1.2fr);
      gap:1.2rem;align-items:start;margin-bottom:1.1rem;
    }
    .badge{
      display:inline-flex;padding:.22rem .7rem;border-radius:999px;
      border:1px solid rgba(56,189,248,.7);
      background:rgba(8,47,73,.96);
      font-size:.7rem;color:#bae6fd;text-transform:uppercase;letter-spacing:.13em;
    }
    h1{margin:.75rem 0 .35rem;font-size:clamp(2.1rem,2.3vw + 1.3rem,2.7rem)}
    .lede{margin:0;color:var(--muted);line-height:1.75;font-size:1.02rem;max-width:46rem}
    .hero-card{
      border-radius:var(--radius);
      padding:1rem 1.1rem 1.15rem;
      background:var(--card);
      border:1px solid rgba(148,163,253,.55);
      box-shadow:var(--shadow);
      font-size:.88rem;color:#e5e7ff;
    }
    .hero-card h2{margin:0 0 .35rem;font-size:1rem}
    .hero-card p{margin:.25rem 0 .4rem;color:var(--muted)}
    .hero-card ul{margin:.3rem 0 0;padding-left:1.1rem;color:var(--muted);font-size:.86rem}
    .hero-card li+li{margin-top:.16rem}

    /* Layout: timeline + preview panel */
    .workspace{
      display:grid;
      grid-template-columns: 1.6fr 0.9fr;
      gap:1.1rem;
      align-items:start;
      margin-top:1rem;
    }

    /* Controls (search/filter/view) */
    .controls{
      border-radius:var(--radius);
      background:var(--glass);
      border:1px solid var(--border2);
      box-shadow:var(--shadow);
      padding:.8rem .9rem;
      display:grid;
      grid-template-columns:1.3fr 1fr 0.9fr;
      gap:.75rem;
      align-items:center;
    }
    .search{
      display:flex;gap:.55rem;align-items:center;
      padding:.45rem .7rem;border-radius:999px;border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,18,.45);
    }
    .search input{
      width:100%;background:transparent;border:none;outline:none;color:var(--text);font-size:.9rem;
    }
    .search input::placeholder{color:rgba(155,164,196,.85)}
    .chips{display:flex;flex-wrap:wrap;gap:.4rem}
    .chip{
      padding:.3rem .6rem;border-radius:999px;border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,18,.38);
      color:var(--muted);font-size:.82rem;cursor:pointer;transition:.16s;user-select:none;white-space:nowrap;
    }
    .chip:hover{transform:translateY(-1px);border-color:rgba(79,209,255,.35);color:var(--text)}
    .chip.active{color:var(--text);border-color:rgba(79,209,255,.55);background:rgba(79,209,255,.12)}
    .view-toggle{display:flex;justify-content:flex-end;gap:.45rem;flex-wrap:wrap}
    .btn{
      padding:.45rem .75rem;border-radius:999px;border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,18,.38);
      color:var(--muted);cursor:pointer;transition:.16s;font-size:.84rem;user-select:none;white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);border-color:rgba(79,209,255,.35);color:var(--text)}
    .btn.active{color:var(--text);border-color:rgba(79,209,255,.55);background:rgba(79,209,255,.12)}

    /* Time scrubber */
    .scrubber{
      margin-top:.9rem;
      border-radius:var(--radius);
      background:rgba(15,23,42,.82);
      border:1px solid rgba(148,163,253,.35);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .scrubber-top{
      display:flex;justify-content:space-between;gap:1rem;align-items:center;
      padding:.75rem .95rem;
      border-bottom:1px solid rgba(255,255,255,.08);
      background:radial-gradient(circle at top, rgba(15,23,42,.96), rgba(8,12,24,.96));
    }
    .scrubber-top h2{margin:0;font-size:1.05rem;letter-spacing:.02em}
    .scrubber-top .meta{color:var(--muted);font-size:.86rem}
    .scrubber-bar{
      padding:.8rem .95rem 1rem;
      background:rgba(8,12,24,.72);
    }
    .range-row{
      display:flex;align-items:center;gap:.75rem;flex-wrap:wrap;
      color:var(--muted);font-size:.86rem;
    }
    input[type="range"]{
      width:360px;max-width:100%;
      accent-color:var(--accent);
    }
    .year-pill{
      padding:.28rem .65rem;border-radius:999px;
      border:1px solid rgba(148,163,253,.35);
      background:rgba(2,6,18,.35);
      color:#e5e7ff;font-size:.84rem;
    }
    .jump{
      margin-left:auto;
      display:flex;gap:.45rem;flex-wrap:wrap;
    }
    .jump button{
      all:unset;
      cursor:pointer;
      padding:.32rem .7rem;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,18,.38);
      color:var(--muted);font-size:.84rem;
      transition:.16s;
    }
    .jump button:hover{transform:translateY(-1px);border-color:rgba(79,209,255,.35);color:var(--text)}

    /* Timeline */
    .timeline-shell{
      border-radius:var(--radius);
      background:rgba(15,23,42,.84);
      border:1px solid rgba(148,163,253,.35);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .timeline-topbar{
      display:flex;justify-content:space-between;gap:.9rem;align-items:baseline;
      padding:.85rem 1rem;
      border-bottom:1px solid rgba(255,255,255,.08);
      background:radial-gradient(circle at top, rgba(15,23,42,.96), rgba(8,12,24,.96));
    }
    .timeline-topbar h2{margin:0;font-size:1.05rem;letter-spacing:.02em}
    .timeline-topbar .meta{color:var(--muted);font-size:.86rem}

    /* Collapsible clusters (details/summary) */
    details.cluster{
      border-top:1px solid rgba(255,255,255,.06);
      background:rgba(8,12,24,.60);
    }
    details.cluster[open]{background:rgba(8,12,24,.72)}
    summary.cluster-head{
      list-style:none;
      cursor:pointer;
      padding:.8rem 1rem;
      display:flex;align-items:center;justify-content:space-between;gap:1rem;
      user-select:none;
    }
    summary.cluster-head::-webkit-details-marker{display:none}
    .cluster-left{
      display:flex;align-items:center;gap:.65rem;flex-wrap:wrap;
    }
    .cluster-title{
      font-size:.95rem;color:var(--text);margin:0;
    }
    .cluster-sub{
      color:var(--muted);font-size:.84rem;
    }
    .cluster-badge{
      padding:.22rem .6rem;border-radius:999px;
      border:1px solid rgba(79,209,255,.25);
      background:rgba(79,209,255,.08);
      color:#dff6ff;font-size:.78rem;
    }
    .chev{
      width:28px;height:28px;border-radius:999px;
      display:grid;place-items:center;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,18,.30);
      color:var(--muted);
      transition:.16s;
    }
    details[open] .chev{transform:rotate(180deg);border-color:rgba(79,209,255,.35);color:var(--text)}
    .cluster-body{
      padding:.85rem 1rem 1.1rem;
    }

    /* Entries list inside cluster */
    .entries{
      display:flex;flex-direction:column;gap:.8rem;
    }
    .entry{
      display:grid;grid-template-columns:46px 1fr;gap:.85rem;align-items:start;
      position:relative;
    }
    .rail-col{display:flex;justify-content:center;position:relative}
    .rail-col::before{
      content:"";
      position:absolute;top:-10px;bottom:-10px;width:3px;border-radius:999px;
      background:linear-gradient(180deg, rgba(79,209,255,0.0), rgba(79,209,255,0.5), rgba(168,85,255,0.55), rgba(79,209,255,0.0));
      box-shadow:0 0 18px rgba(79,209,255,0.35);
      opacity:.85;
    }
    .node{
      width:18px;height:18px;border-radius:50%;
      margin-top:.4rem;
      background:radial-gradient(circle at 35% 35%, rgba(255,255,255,.9), rgba(79,209,255,.7), rgba(2,6,18,.2));
      border:1px solid rgba(255,255,255,.18);
      box-shadow:0 0 18px rgba(79,209,255,.45);
      position:relative;
    }
    .node::after{
      content:"";position:absolute;inset:-10px;border-radius:999px;
      background:radial-gradient(circle, rgba(79,209,255,.18), transparent 60%);
      opacity:.8;
    }

    .tile{
      border-radius:var(--radius);
      background:rgba(15,23,42,.94);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 12px 40px rgba(0,0,0,.45);
      padding:.85rem .95rem .9rem;
      position:relative;
      overflow:hidden;
      cursor:pointer;
      outline:none;
    }
    .tile::before{
      content:"";
      position:absolute;inset:0;
      background:
        radial-gradient(circle at 12% 15%, rgba(79,209,255,.12), transparent 42%),
        radial-gradient(circle at 88% 80%, rgba(168,85,255,.12), transparent 44%);
      pointer-events:none;
    }
    .tile:focus-visible{
      box-shadow:0 0 0 3px rgba(79,209,255,.35), 0 12px 40px rgba(0,0,0,.45);
      border-color:rgba(79,209,255,.45);
    }
    .tile.selected{
      border-color:rgba(79,209,255,.55);
      background:rgba(15,23,42,.98);
    }

    .kicker{
      display:inline-flex;align-items:center;gap:.45rem;
      font-size:.76rem;color:var(--muted);letter-spacing:.12em;text-transform:uppercase;
      margin-bottom:.35rem;position:relative;
    }
    .tag{
      padding:.18rem .5rem;border-radius:999px;border:1px solid rgba(255,255,255,.10);
      background:rgba(2,6,18,.35);font-size:.72rem;color:var(--muted);
    }
    .title{margin:0 0 .2rem;font-size:1.02rem;color:var(--text);letter-spacing:.01em;position:relative}
    .range{color:var(--muted);font-size:.86rem;margin:0 0 .35rem;position:relative}
    .desc{margin:0 0 .55rem;color:var(--muted);line-height:1.6;font-size:.92rem;position:relative}
    .actions{display:flex;flex-wrap:wrap;gap:.45rem;align-items:center;position:relative}
    .pilllink{
      display:inline-flex;align-items:center;justify-content:center;gap:.35rem;
      padding:.32rem .68rem;border-radius:999px;
      border:1px solid rgba(148,163,253,.65);
      background:rgba(30,64,175,.25);
      color:#e5e7ff;text-decoration:none;font-size:.84rem;font-weight:500;
      transition:.16s;
    }
    .pilllink:hover{
      border-color:rgba(79,209,255,.8);
      background:rgba(79,209,255,.14);
      transform:translateY(-1px);
      text-decoration:none;
    }
    .mini-links{color:var(--muted);font-size:.86rem;line-height:1.6;margin-top:.25rem;position:relative}

    /* Cards view */
    .cards-wrap{display:none}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.1rem}
    .card{
      padding:1rem 1.15rem 1.1rem;
      border-radius:var(--radius);
      background:rgba(15,23,42,.94);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:var(--shadow);
      color:var(--muted);
      position:relative;overflow:hidden;
    }
    .card::before{
      content:"";position:absolute;inset:0;
      background:
        radial-gradient(circle at 12% 15%, rgba(79,209,255,.10), transparent 44%),
        radial-gradient(circle at 88% 80%, rgba(168,85,255,.10), transparent 46%);
      pointer-events:none;
    }
    .card h3{margin:0 0 .35rem;font-size:1rem;color:var(--accent);position:relative}
    .card p{margin:0 0 .55rem;position:relative}
    .card .pilllink{position:relative}

    /* Preview panel (mini star-map) */
    .preview{
      position:sticky;
      top:92px;
      border-radius:var(--radius);
      background:rgba(15,23,42,.86);
      border:1px solid rgba(148,163,253,.35);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .preview-top{
      padding:.85rem 1rem;
      border-bottom:1px solid rgba(255,255,255,.08);
      background:radial-gradient(circle at top, rgba(15,23,42,.96), rgba(8,12,24,.96));
    }
    .preview-top h2{margin:0;font-size:1.05rem;letter-spacing:.02em}
    .preview-top .meta{margin:.2rem 0 0;color:var(--muted);font-size:.86rem}
    .starmap{
      height:240px;
      background:
        radial-gradient(circle at 50% 45%, rgba(79,209,255,.12), transparent 55%),
        radial-gradient(circle at 70% 70%, rgba(168,85,255,.10), transparent 60%),
        linear-gradient(180deg, rgba(2,6,18,.35), rgba(2,6,18,.85));
      position:relative;
      overflow:hidden;
    }
    .starmap canvas{position:absolute;inset:0;width:100%;height:100%}
    .preview-body{
      padding:.9rem 1rem 1.1rem;
    }
    .sel-title{margin:0 0 .25rem;font-size:1.05rem}
    .sel-range{margin:0 0 .55rem;color:var(--muted);font-size:.88rem}
    .sel-desc{margin:0 0 .75rem;color:var(--muted);line-height:1.65;font-size:.92rem}
    .sel-actions{display:flex;flex-wrap:wrap;gap:.45rem}
    .hint{
      margin-top:.7rem;
      padding:.55rem .7rem;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(2,6,18,.30);
      color:var(--muted);
      font-size:.84rem;
      line-height:1.55;
    }

    footer{
      max-width:var(--max);margin:0 auto;
      padding:1.4rem 1.5rem 1.6rem;
      font-size:.8rem;color:var(--muted);
      border-top:1px solid rgba(15,23,42,.8);
      text-align:center;
      background:radial-gradient(circle at top, rgba(15,23,42,.96), rgba(3,7,18,.96));
    }

    @media (max-width: 980px){
      .hero{grid-template-columns:1fr}
      .workspace{grid-template-columns:1fr}
      .preview{position:relative;top:auto}
      .controls{grid-template-columns:1fr}
      .view-toggle{justify-content:flex-start}
    }
  </style>
</head>

<body>
  <div class="wormhole-ring"></div>

  <header>
    <nav class="nav">
      <div class="nav-left">
        <div class="nav-logo"></div>
        <div class="nav-title">
          fournel.org
          <span>Futures &amp; Timelines</span>
        </div>
      </div>
      <div class="nav-links">
        <a href="index.htm">Home</a>
        <a href="history.htm">History</a>
        <a href="tech.htm">Technology</a>
        <a href="future.htm" class="active">Future</a>
        <a href="religion.htm">Religion</a>
        <a href="science.htm">Science</a>
        <a href="about.htm">About</a>
      </div>
    </nav>
  </header>

  <main>
    <section class="hero">
      <div>
        <div class="badge">Speculative Timelines · Post-2025</div>
        <h1>Future hub: scrub time, open branches, explore outcomes.</h1>
        <p class="lede">
          Same scenario set and links — now presented as an interactive timeline console:
          <strong>scrub</strong> across centuries, <strong>cluster</strong> by theme, and preview a branch on the star-map.
          Click any node to open the dedicated scenario page.
        </p>
      </div>

      <aside class="hero-card">
        <h2>What’s here</h2>
        <p>Nodes link to scenario pages you already have:</p>
        <ul>
          <li><strong>WW3</strong>, <strong>Skynet</strong>, <strong>Alien Contact</strong>, <strong>Alien Armada</strong>, <strong>AI Futures</strong></li>
          <li><strong>Bahá’í future timeline</strong> &amp; civilisational arc</li>
          <li><strong>Solar System in 3000 AD</strong> (and key world pages)</li>
        </ul>
      </aside>
    </section>

    <!-- Controls -->
    <section class="controls" aria-label="Timeline controls">
      <div class="search" role="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="rgba(244,247,255,0.9)" stroke-width="1.6"/>
          <path d="M16.5 16.5 21 21" stroke="rgba(244,247,255,0.9)" stroke-width="1.6" stroke-linecap="round"/>
        </svg>
        <input id="q" type="search" placeholder="Search timelines (e.g., 'alien', 'singularity', '3000')…" />
      </div>

      <div class="chips" aria-label="Filter chips">
        <div class="chip active" data-filter="all">All</div>
        <div class="chip" data-filter="near">Near-Future (2025–2100)</div>
        <div class="chip" data-filter="civil">Civilisational Futures</div>
        <div class="chip" data-filter="solar">Solar System 3000</div>
      </div>

      <div class="view-toggle" aria-label="View toggle">
        <div class="btn active" id="viewTimeline" role="button" tabindex="0">Timeline</div>
        <div class="btn" id="viewCards" role="button" tabindex="0">Cards</div>
      </div>
    </section>

    <!-- Time scrubber -->
    <section class="scrubber" aria-label="Time scrubber">
      <div class="scrubber-top">
        <h2>Time Scrubber</h2>
        <div class="meta">Drag to jump near a year (2000 → 3000). Nearest node will auto-select.</div>
      </div>
      <div class="scrubber-bar">
        <div class="range-row">
          <span class="year-pill" id="yearPill">Year: 2025</span>
          <input id="yearRange" type="range" min="2000" max="3000" value="2025" />
          <div class="jump">
            <button data-jump="2025">2025</button>
            <button data-jump="2050">2050</button>
            <button data-jump="2100">2100</button>
            <button data-jump="2500">2500</button>
            <button data-jump="3000">3000</button>
          </div>
        </div>
      </div>
    </section>

    <section class="workspace">
      <!-- Timeline / Cards -->
      <div>
        <section class="timeline-shell" id="timelineShell" aria-label="Timeline view">
          <div class="timeline-topbar">
            <h2>Timeline Interface</h2>
            <div class="meta"><span id="count">0</span> nodes · click a node to preview + open</div>
          </div>

          <!-- Clusters -->
          <details class="cluster" open data-cluster="near">
            <summary class="cluster-head">
              <div class="cluster-left">
                <span class="cluster-badge">Cluster</span>
                <div>
                  <div class="cluster-title">Near-Future Timelines</div>
                  <div class="cluster-sub">War, AI escalation, first contact · 2025–2100</div>
                </div>
              </div>
              <div class="chev">▾</div>
            </summary>
            <div class="cluster-body">
              <div class="entries" id="entriesNear"></div>
            </div>
          </details>

          <details class="cluster" open data-cluster="civil">
            <summary class="cluster-head">
              <div class="cluster-left">
                <span class="cluster-badge">Cluster</span>
                <div>
                  <div class="cluster-title">Civilisational Futures</div>
                  <div class="cluster-sub">Governance, peace trajectories, long arcs · 2025–3000</div>
                </div>
              </div>
              <div class="chev">▾</div>
            </summary>
            <div class="cluster-body">
              <div class="entries" id="entriesCivil"></div>
            </div>
          </details>

          <details class="cluster" open data-cluster="solar">
            <summary class="cluster-head">
              <div class="cluster-left">
                <span class="cluster-badge">Cluster</span>
                <div>
                  <div class="cluster-title">Solar System in 3000 AD</div>
                  <div class="cluster-sub">Sol Federation, habitats, key world pages · 3000 AD</div>
                </div>
              </div>
              <div class="chev">▾</div>
            </summary>
            <div class="cluster-body">
              <div class="entries" id="entriesSolar"></div>
            </div>
          </details>
        </section>

        <!-- Cards View -->
        <section class="cards-wrap" id="cardsWrap" aria-label="Cards view">
          <div class="grid" id="cards"></div>
        </section>
      </div>

      <!-- Preview Panel -->
      <aside class="preview" aria-label="Scenario preview panel">
        <div class="preview-top">
          <h2>Preview</h2>
          <div class="meta">Select a node to see details and a mini “star-map”</div>
        </div>
        <div class="starmap">
          <canvas id="starCanvas"></canvas>
        </div>
        <div class="preview-body">
          <h3 class="sel-title" id="selTitle">Select a node…</h3>
          <div class="sel-range" id="selRange">—</div>
          <p class="sel-desc" id="selDesc">Click any timeline node to preview it here.</p>
          <div class="sel-actions" id="selActions"></div>

          <div class="hint">
            Tip: Use the <strong>Time Scrubber</strong> to jump near a year, then open the nearest node.
            Use filters to isolate Near-Future / Civilisational / Solar content.
          </div>
        </div>
      </aside>
    </section>
  </main>

  <footer>
    © <span id="year"></span> Dan Fournel · fournel.org · Futures Hub
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // ===== Same data + links as before (kept intact) =====
    // Add explicit years for scrubber/nearest selection.
    // cat: near | civil | solar
    const NODES = [
      {
        id: "ww3",
        cat: "near",
        kicker: "Near-Future Timelines",
        tag: "Conflict",
        title: "World War III · 2027–2037",
        range: "2027–2037",
        startYear: 2027,
        endYear: 2037,
        desc: "A branching timeline in which a European crisis and Pacific tension cascade into a decade-long global war. Tracks alliances, campaigns, and the post-war order emerging after 2037.",
        href: "ww3.htm",
        linkLabel: "Open ww3.htm",
        keywords: ["ww3","world war","war","geopolitics","2037"]
      },
      {
        id: "skynet",
        cat: "near",
        kicker: "Near-Future Timelines",
        tag: "AI Escalation",
        title: "Skynet 2027 Scenario",
        range: "2000–2100",
        startYear: 2000,
        endYear: 2100,
        desc: "An AI defence network comes online in 2027 and begins to reshape warfare, politics, and everyday life – but without time travel. Timeline runs from 2000 to 2100 and charts the rise and response.",
        href: "skynet.htm",
        linkLabel: "Open skynet.htm",
        keywords: ["skynet","ai","defence","automation","2100"]
      },
      {
        id: "alien",
        cat: "near",
        kicker: "Near-Future Timelines",
        tag: "First Contact",
        title: "Alien Contact · 2026 Exchange",
        range: "2026–2126",
        startYear: 2026,
        endYear: 2126,
        desc: "Aliens arrive in 2026 seeking a critical mineral only Earth can supply. In exchange for advanced technology, humanity enters a 100-year resource and knowledge partnership.",
        href: "alien.htm",
        linkLabel: "Open alien.htm",
        keywords: ["alien","first contact","exchange","2026","mineral"]
      },
      {
        id: "alien_attack",
        cat: "near",
        kicker: "Near-Future Timelines",
        tag: "Invasion",
        title: "Alien Armada · “Your World Is Now Ours”",
        range: "2026–?",
        startYear: 2026,
        endYear: 2050,
        desc: "A hostile takeover branch: a message arrives in 2026, followed by a massive armada within a year. Chronicles humanity’s response to an overwhelming extraterrestrial threat.",
        href: "alien_attack.htm",
        linkLabel: "Open alien_attack.htm",
        keywords: ["alien","armada","invasion","2026","attack"]
      },
      {
        id: "ai",
        cat: "near",
        kicker: "Near-Future Timelines",
        tag: "Singularity",
        title: "AI Futures · 2000–3000+",
        range: "2000–3000+",
        startYear: 2000,
        endYear: 3000,
        desc: "A long-range timeline tracing artificial intelligence from early machine learning to recursive improvement, the Technological Singularity (2070–2085 window), and post-singularity civilisation out to 3000 AD and beyond.",
        href: "ai.htm",
        linkLabel: "Open ai.htm",
        keywords: ["ai","singularity","recursive","3000","future"]
      },
      {
        id: "bahai",
        cat: "civil",
        kicker: "Civilisational Futures",
        tag: "Governance",
        title: "Bahá’í Future Timeline · 2025–3000",
        range: "2025–3000",
        startYear: 2025,
        endYear: 3000,
        desc: "A staged view of the Lesser Peace, evolving world governance, and the Great Peace in a realistic, geopolitically grounded way. Decade by decade until 2100, then century by century to 3000.",
        href: "bahai.htm",
        linkLabel: "Open bahai.htm",
        keywords: ["bahai","peace","world governance","3000","lesser peace"]
      },
      {
        id: "terra",
        cat: "civil",
        kicker: "Civilisational Futures",
        tag: "Terra",
        title: "Terra · Earth in 3000 AD",
        range: "3000 AD",
        startYear: 3000,
        endYear: 3000,
        desc: "A focused view on Earth itself: stabilised climate, re-architected cities, and a world that is part of a bigger Sol-wide federation rather than the sole centre of gravity.",
        href: "terra.htm",
        linkLabel: "Open terra.htm",
        keywords: ["terra","earth","3000","cities","climate"]
      },
      {
        id: "solar",
        cat: "solar",
        kicker: "Solar System in 3000 AD",
        tag: "Sol System",
        title: "Solar System Overview · 3000 AD",
        range: "3000 AD",
        startYear: 3000,
        endYear: 3000,
        desc: "A top-level map of life across Terra, Luna, Mars, Titan, Europa, and the orbital habitat networks. How the Sol Federation functions, who does what, and where value flows.",
        href: "solar.htm",
        linkLabel: "Open solar.htm",
        keywords: ["solar","sol","3000","habitats","federation"]
      },
      {
        id: "worlds",
        cat: "solar",
        kicker: "Solar System in 3000 AD",
        tag: "World Pages",
        title: "Planetary Futures · Key Worlds",
        range: "3000 AD",
        startYear: 3000,
        endYear: 3000,
        desc: "Deep dives into individual worlds and moons: architecture, transport, politics, and economics in 3000 AD.",
        href: "solar.htm",
        linkLabel: "Open solar.htm",
        extraLinksHtml:
          '• <a href="terra.htm">Terra</a> – Earth re-architected<br />' +
          '• <a href="luna.htm">Luna</a> – the Earth–space hinge<br />' +
          '• <a href="mars.htm">Mars</a> – red world going green<br />' +
          '• <a href="titan.htm">Titan</a> – orange skies &amp; methane seas<br />' +
          '• <a href="europa.htm">Europa</a> – under-ice ocean labs',
        keywords: ["luna","mars","titan","europa","terra","3000"]
      }
    ];

    // ===== Elements =====
    const qEl = document.getElementById("q");
    const chipEls = Array.from(document.querySelectorAll(".chip"));
    const countEl = document.getElementById("count");

    const entriesNear = document.getElementById("entriesNear");
    const entriesCivil = document.getElementById("entriesCivil");
    const entriesSolar = document.getElementById("entriesSolar");

    const cardsWrap = document.getElementById("cardsWrap");
    const timelineShell = document.getElementById("timelineShell");
    const cardsEl = document.getElementById("cards");

    const viewTimelineBtn = document.getElementById("viewTimeline");
    const viewCardsBtn = document.getElementById("viewCards");

    const yearRange = document.getElementById("yearRange");
    const yearPill = document.getElementById("yearPill");
    const jumpButtons = Array.from(document.querySelectorAll(".jump button"));

    // Preview
    const selTitle = document.getElementById("selTitle");
    const selRange = document.getElementById("selRange");
    const selDesc = document.getElementById("selDesc");
    const selActions = document.getElementById("selActions");

    // ===== State =====
    let activeFilter = "all";
    let selectedId = null;

    // ===== Helpers =====
    function matches(node, query){
      if(!query) return true;
      const q = query.toLowerCase().trim();
      const hay = [
        node.title, node.desc, node.range, node.kicker, node.tag,
        ...(node.keywords || [])
      ].join(" ").toLowerCase();
      return hay.includes(q);
    }

    function filterNodes(){
      const query = qEl.value || "";
      return NODES.filter(n => {
        const okCat = (activeFilter === "all") ? true : n.cat === activeFilter;
        return okCat && matches(n, query);
      });
    }

    function sortByYearThenTitle(a,b){
      const ay = a.startYear ?? 0;
      const by = b.startYear ?? 0;
      if(ay !== by) return ay - by;
      return (a.title || "").localeCompare(b.title || "");
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;").replaceAll("<","&lt;")
        .replaceAll(">","&gt;").replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function entryHtml(n){
      const extra = n.extraLinksHtml
        ? `<div class="mini-links">${n.extraLinksHtml}</div>`
        : "";

      return `
        <div class="entry" data-id="${escapeHtml(n.id)}" data-year="${n.startYear || 0}">
          <div class="rail-col" aria-hidden="true">
            <div class="node"></div>
          </div>
          <div class="tile" tabindex="0" role="button" aria-label="Select ${escapeHtml(n.title)}">
            <div class="kicker">
              <span>${escapeHtml(n.kicker)}</span>
              <span class="tag">${escapeHtml(n.tag)}</span>
            </div>
            <div class="title">${escapeHtml(n.title)}</div>
            <div class="range">${escapeHtml(n.range)}</div>
            <p class="desc">${escapeHtml(n.desc)}</p>
            <div class="actions">
              <a class="pilllink" href="${escapeHtml(n.href)}">${escapeHtml(n.linkLabel)}</a>
            </div>
            ${extra}
          </div>
        </div>
      `;
    }

    function cardHtml(n){
      const extra = n.extraLinksHtml
        ? `<p style="margin-top:0.25rem; line-height:1.6; color: var(--muted);">${n.extraLinksHtml}</p>`
        : "";

      return `
        <div class="card">
          <h3>${escapeHtml(n.title)}</h3>
          <p><span style="color:var(--muted)">${escapeHtml(n.range)}</span> · <span style="color:var(--muted)">${escapeHtml(n.tag)}</span></p>
          <p>${escapeHtml(n.desc)}</p>
          <a href="${escapeHtml(n.href)}" class="pilllink">${escapeHtml(n.linkLabel)}</a>
          ${extra}
        </div>
      `;
    }

    function setView(view){
      const isTimeline = view === "timeline";
      timelineShell.style.display = isTimeline ? "block" : "none";
      cardsWrap.style.display = isTimeline ? "none" : "block";
      viewTimelineBtn.classList.toggle("active", isTimeline);
      viewCardsBtn.classList.toggle("active", !isTimeline);
    }

    function setFilter(filter){
      activeFilter = filter;
      chipEls.forEach(c => c.classList.toggle("active", c.dataset.filter === filter));
      render();
    }

    function findNodeById(id){
      return NODES.find(n => n.id === id) || null;
    }

    function selectNode(id, {scrollIntoView=false} = {}){
      selectedId = id;

      // highlight tiles
      document.querySelectorAll(".tile.selected").forEach(t => t.classList.remove("selected"));
      const entry = document.querySelector(`.entry[data-id="${CSS.escape(id)}"]`);
      if(entry){
        const tile = entry.querySelector(".tile");
        if(tile) tile.classList.add("selected");
        if(scrollIntoView){
          entry.scrollIntoView({behavior:"smooth", block:"center"});
        }
      }

      // update preview panel
      const n = findNodeById(id);
      if(!n) return;

      selTitle.textContent = n.title;
      selRange.textContent = n.range;
      selDesc.textContent = n.desc;

      selActions.innerHTML = `
        <a class="pilllink" href="${n.href}">${n.linkLabel}</a>
      `;

      // optional: extra links
      if(n.extraLinksHtml){
        selActions.insertAdjacentHTML("beforeend", `
          <span style="flex-basis:100%;height:0;"></span>
          <div style="color:var(--muted);font-size:.88rem;line-height:1.6;margin-top:.35rem;">
            ${n.extraLinksHtml}
          </div>
        `);
      }

      // re-seed constellation for this node
      setConstellationFor(n);
    }

    // ===== Render =====
    function render(){
      const nodes = filterNodes().slice().sort(sortByYearThenTitle);
      countEl.textContent = String(nodes.length);

      const near = nodes.filter(n => n.cat === "near");
      const civil = nodes.filter(n => n.cat === "civil");
      const solar = nodes.filter(n => n.cat === "solar");

      entriesNear.innerHTML = near.map(entryHtml).join("");
      entriesCivil.innerHTML = civil.map(entryHtml).join("");
      entriesSolar.innerHTML = solar.map(entryHtml).join("");

      cardsEl.innerHTML = nodes.map(cardHtml).join("");

      // attach click + keyboard handlers to tiles
      document.querySelectorAll(".entry").forEach(entry => {
        const id = entry.dataset.id;
        const tile = entry.querySelector(".tile");
        if(!tile) return;

        tile.addEventListener("click", (e) => {
          // don’t override link clicks
          if(e.target && e.target.closest("a")) return;
          selectNode(id);
        });

        tile.addEventListener("keydown", (e) => {
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            selectNode(id, {scrollIntoView:true});
          }
        });
      });

      // Preserve selection if still visible, else select first
      if(selectedId){
        const still = nodes.some(n => n.id === selectedId);
        if(!still) selectedId = null;
      }
      if(!selectedId && nodes.length){
        selectNode(nodes[0].id);
      } else if(selectedId){
        selectNode(selectedId);
      }
    }

    // ===== Controls wiring =====
    qEl.addEventListener("input", () => render());

    chipEls.forEach(chip => {
      chip.addEventListener("click", () => setFilter(chip.dataset.filter));
    });

    viewTimelineBtn.addEventListener("click", () => setView("timeline"));
    viewCardsBtn.addEventListener("click", () => setView("cards"));

    [viewTimelineBtn, viewCardsBtn].forEach(btn => {
      btn.addEventListener("keydown", (e) => {
        if(e.key === "Enter" || e.key === " "){
          e.preventDefault(); btn.click();
        }
      });
    });

    // ===== Time scrubber behavior =====
    function updateYearPill(y){
      yearPill.textContent = `Year: ${y}`;
    }

    function nearestNodeToYear(year){
      const nodes = filterNodes();
      if(!nodes.length) return null;
      // choose nearest by startYear, tie-breaker by shorter distance to midpoint
      let best = null;
      let bestDist = Infinity;
      for(const n of nodes){
        const s = n.startYear ?? 0;
        const e = n.endYear ?? s;
        const mid = (s + e) / 2;
        const dist = Math.min(Math.abs(year - s), Math.abs(year - mid), Math.abs(year - e));
        if(dist < bestDist){
          bestDist = dist;
          best = n;
        }
      }
      return best;
    }

    yearRange.addEventListener("input", () => {
      const y = parseInt(yearRange.value, 10);
      updateYearPill(y);
      const nearest = nearestNodeToYear(y);
      if(nearest) selectNode(nearest.id);
    });

    jumpButtons.forEach(b => {
      b.addEventListener("click", () => {
        const y = parseInt(b.dataset.jump, 10);
        yearRange.value = String(y);
        updateYearPill(y);
        const nearest = nearestNodeToYear(y);
        if(nearest) selectNode(nearest.id, {scrollIntoView:true});
      });
    });

    // ===== Star-map preview (mini “Eyes-like” vibe) =====
    const canvas = document.getElementById("starCanvas");
    const ctx = canvas.getContext("2d");
    let stars = [];
    let lines = [];
    let tw = 0;
    let constellationSeed = 1;
    let hueA = 195; // accent
    let hueB = 275; // accent2

    function resizeCanvas(){
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.floor(rect.width * devicePixelRatio);
      canvas.height = Math.floor(rect.height * devicePixelRatio);
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }

    function mulberry32(a){
      return function(){
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      }
    }

    function makeStarfield(seed){
      const rand = mulberry32(seed);
      const w = canvas.getBoundingClientRect().width;
      const h = canvas.getBoundingClientRect().height;

      stars = [];
      const count = Math.max(70, Math.floor((w*h) / 1800));
      for(let i=0;i<count;i++){
        stars.push({
          x: rand()*w,
          y: rand()*h,
          r: 0.5 + rand()*1.6,
          a: 0.25 + rand()*0.75,
          s: 0.15 + rand()*0.55, // twinkle speed
          p: rand()*Math.PI*2
        });
      }

      // constellation: pick 8–12 stars and link them
      const picks = [];
      const pickCount = 9 + Math.floor(rand()*4);
      for(let i=0;i<pickCount;i++){
        picks.push(stars[Math.floor(rand()*stars.length)]);
      }

      lines = [];
      for(let i=0;i<picks.length-1;i++){
        lines.push({a:picks[i], b:picks[i+1]});
      }
    }

    function setConstellationFor(node){
      // change palette + seed based on category/tag to give each node a different “signature”
      let seed = 1;
      const s = (node.id || "") + "|" + (node.cat || "") + "|" + (node.tag || "") + "|" + (node.startYear||0);
      for(let i=0;i<s.length;i++) seed = (seed*31 + s.charCodeAt(i)) >>> 0;

      constellationSeed = seed;
      if(node.cat === "near"){ hueA = 195; hueB = 275; }
      if(node.cat === "civil"){ hueA = 165; hueB = 255; }
      if(node.cat === "solar"){ hueA = 45;  hueB = 210; }

      makeStarfield(constellationSeed);
    }

    function draw(){
      const w = canvas.getBoundingClientRect().width;
      const h = canvas.getBoundingClientRect().height;

      ctx.clearRect(0,0,w,h);

      // nebula glow
      const g = ctx.createRadialGradient(w*0.52,h*0.45, 20, w*0.52,h*0.45, Math.max(w,h)*0.9);
      g.addColorStop(0, `hsla(${hueA}, 95%, 60%, 0.12)`);
      g.addColorStop(0.55, `hsla(${hueB}, 85%, 55%, 0.08)`);
      g.addColorStop(1, "rgba(0,0,0,0)");
      ctx.fillStyle = g;
      ctx.fillRect(0,0,w,h);

      // stars
      tw += 0.016;
      for(const st of stars){
        const twk = (Math.sin(tw*st.s + st.p) + 1) / 2; // 0..1
        const alpha = st.a * (0.55 + twk*0.65);
        ctx.beginPath();
        ctx.fillStyle = `rgba(244,247,255,${alpha})`;
        ctx.arc(st.x, st.y, st.r, 0, Math.PI*2);
        ctx.fill();
      }

      // constellation lines
      ctx.lineWidth = 1;
      ctx.strokeStyle = `hsla(${hueA}, 95%, 62%, 0.30)`;
      ctx.shadowColor = `hsla(${hueA}, 95%, 62%, 0.25)`;
      ctx.shadowBlur = 12;

      ctx.beginPath();
      for(const ln of lines){
        ctx.moveTo(ln.a.x, ln.a.y);
        ctx.lineTo(ln.b.x, ln.b.y);
      }
      ctx.stroke();
      ctx.shadowBlur = 0;

      requestAnimationFrame(draw);
    }

    window.addEventListener("resize", () => {
      resizeCanvas();
      makeStarfield(constellationSeed);
    });

    // ===== Init =====
    setView("timeline");
    resizeCanvas();
    makeStarfield(1);
    requestAnimationFrame(draw);

    // Filters default
    setFilter("all");
    updateYearPill(parseInt(yearRange.value,10));
    render();
  </script>
</body>
</html>
